{"ast":null,"code":"var _jsxFileName = \"/Users/wchen/Dropbox/UMN/2019_Fall/Job/code sample/sample/co2_emission/src/components/MapChartWrapper.js\";\nimport React, { Component } from \"react\";\nimport allData from \"../data/all_data.csv\";\nimport MapChart from \"./MapChart\";\nimport * as d3 from \"d3\";\nimport * as topojson from \"topojson\";\nimport \"../css/MapChartWrapper.css\";\n\nclass MapChartWrapper extends Component {\n  constructor() {\n    super();\n    this.state = {\n      data: \"\",\n      extremeYears: \"\",\n      currentYear: \"\",\n      currentDataType: \"\",\n      geoData: \"\",\n      width: \"\",\n      height: \"\"\n    };\n    var promises = [d3.json(\"http://unpkg.com/world-atlas@1.1.4/world/50m.json\"), d3.csv(allData, row => {\n      return {\n        continent: row.Continent,\n        country: row.Country,\n        countryCode: row[\"Country Code\"],\n        emissions: +row[\"Emissions\"],\n        emissionsPerCapita: +row[\"Emissions Per Capita\"],\n        region: row.Region,\n        year: +row.Year\n      };\n    })];\n    Promise.all(promises).then(data => {\n      this.ready.bind(this)(data[0], data[1]);\n    }).catch(error => {\n      console.log(\"error\", error);\n    });\n  }\n\n  ready(mapData, data) {\n    var extremeYears = d3.extent(data, d => d.year);\n    var currentYear = extremeYears[0];\n    var currentDataType = d3.select('input[name=\"data-type\"]:checked').attr(\"value\");\n    console.log(\"ho??\", currentDataType);\n    var geoData = topojson.feature(mapData, mapData.objects.countries).features;\n    var width = +d3.select(\".chart-container\").node().offsetWidth;\n    var height = 300;\n    this.setState({\n      data,\n      extremeYears,\n      currentYear,\n      currentDataType,\n      geoData,\n      width,\n      height,\n      mapchart: new MapChart(this.refs.mapChart)\n    });\n    this.state.mapchart.drawMap(geoData, data, currentYear, currentDataType);\n    d3.selectAll('input[name=\"data-type\"]').on(\"change\", () => {\n      var active = d3.select(\".active\").data()[0];\n      var country = active ? active.properties.country : \"\";\n      currentDataType = d3.event.target.value;\n      this.state.mapchart.drawMap(geoData, data, currentYear, currentDataType); //   drawBar(data, currentDataType, country);\n    });\n  }\n\n  componentDidMount() {// this.setState({\n    //   mapchart: new MapChart(this.refs.mapChart)\n    // });\n  }\n\n  shouldComponentUpdate() {\n    return false;\n  }\n\n  componentWillReceiveProps() {} //     const { geoData, data, currentYear } = this.state;\n  //     this.state.mapchart.drawMap(geoData, data, currentYear);\n  // const { geoData, data, currentYear, currentDataType } = this.state;\n  // this.state.mapchart.drawMap(geoData, data, currentYear, currentDataType);\n  //   componentWillReceiveProps(nextProps) {\n  //     this.state.chart.update3(nextProps.gender);\n  //   }\n\n\n  render() {\n    const {\n      width,\n      height,\n      currentDataType\n    } = this.state;\n    console.log(\"currentDataType:\", currentDataType);\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      id: \"nav\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }, \"CO\", React.createElement(\"sub\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, \"2\"), \" Dashboard\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, \"Explore CO\", React.createElement(\"sub\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, \"2\"), \" emissions by year. Current year:\", \" \", React.createElement(\"span\", {\n      id: \"year-val\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      id: \"year\",\n      type: \"range\",\n      step: \"1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    })), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, \"Choose between total emissions or emissions per capita.\", React.createElement(\"input\", {\n      type: \"radio\",\n      name: \"data-type\",\n      value: \"emissions\",\n      defaultChecked: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, \"Emissions\"), React.createElement(\"input\", {\n      type: \"radio\",\n      name: \"data-type\",\n      value: \"emissionsPerCapita\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, \"Emissions Per Capita\")), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, \"Click on a country to see its trends by year.\")), React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"chart-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      ref: \"mapChart\",\n      style: {\n        width: width,\n        height: height\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }))));\n  }\n\n}\n\nexport default MapChartWrapper;","map":{"version":3,"sources":["/Users/wchen/Dropbox/UMN/2019_Fall/Job/code sample/sample/co2_emission/src/components/MapChartWrapper.js"],"names":["React","Component","allData","MapChart","d3","topojson","MapChartWrapper","constructor","state","data","extremeYears","currentYear","currentDataType","geoData","width","height","promises","json","csv","row","continent","Continent","country","Country","countryCode","emissions","emissionsPerCapita","region","Region","year","Year","Promise","all","then","ready","bind","catch","error","console","log","mapData","extent","d","select","attr","feature","objects","countries","features","node","offsetWidth","setState","mapchart","refs","mapChart","drawMap","selectAll","on","active","properties","event","target","value","componentDidMount","shouldComponentUpdate","componentWillReceiveProps","render"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport allData from \"../data/all_data.csv\";\nimport MapChart from \"./MapChart\";\nimport * as d3 from \"d3\";\nimport * as topojson from \"topojson\";\nimport \"../css/MapChartWrapper.css\";\n\nclass MapChartWrapper extends Component {\n  constructor() {\n    super();\n    this.state = {\n      data: \"\",\n      extremeYears: \"\",\n      currentYear: \"\",\n      currentDataType: \"\",\n      geoData: \"\",\n      width: \"\",\n      height: \"\"\n    };\n\n    var promises = [\n      d3.json(\"http://unpkg.com/world-atlas@1.1.4/world/50m.json\"),\n      d3.csv(allData, row => {\n        return {\n          continent: row.Continent,\n          country: row.Country,\n          countryCode: row[\"Country Code\"],\n          emissions: +row[\"Emissions\"],\n          emissionsPerCapita: +row[\"Emissions Per Capita\"],\n          region: row.Region,\n          year: +row.Year\n        };\n      })\n    ];\n    Promise.all(promises)\n      .then(data => {\n        this.ready.bind(this)(data[0], data[1]);\n      })\n      .catch(error => {\n        console.log(\"error\", error);\n      });\n  }\n\n  ready(mapData, data) {\n    var extremeYears = d3.extent(data, d => d.year);\n    var currentYear = extremeYears[0];\n    var currentDataType = d3\n      .select('input[name=\"data-type\"]:checked')\n      .attr(\"value\");\n    console.log(\"ho??\", currentDataType);\n\n    var geoData = topojson.feature(mapData, mapData.objects.countries).features;\n\n    var width = +d3.select(\".chart-container\").node().offsetWidth;\n\n    var height = 300;\n\n    this.setState({\n      data,\n      extremeYears,\n      currentYear,\n      currentDataType,\n      geoData,\n      width,\n      height,\n      mapchart: new MapChart(this.refs.mapChart)\n    });\n\n    this.state.mapchart.drawMap(geoData, data, currentYear, currentDataType);\n\n    d3.selectAll('input[name=\"data-type\"]').on(\"change\", () => {\n      var active = d3.select(\".active\").data()[0];\n      var country = active ? active.properties.country : \"\";\n      currentDataType = d3.event.target.value;\n      this.state.mapchart.drawMap(geoData, data, currentYear, currentDataType);\n      //   drawBar(data, currentDataType, country);\n    });\n  }\n\n  componentDidMount() {\n    // this.setState({\n    //   mapchart: new MapChart(this.refs.mapChart)\n    // });\n  }\n\n  shouldComponentUpdate() {\n    return false;\n  }\n\n  componentWillReceiveProps() {\n    //     const { geoData, data, currentYear } = this.state;\n    //     this.state.mapchart.drawMap(geoData, data, currentYear);\n    // const { geoData, data, currentYear, currentDataType } = this.state;\n    // this.state.mapchart.drawMap(geoData, data, currentYear, currentDataType);\n  }\n\n  //   componentWillReceiveProps(nextProps) {\n  //     this.state.chart.update3(nextProps.gender);\n  //   }\n\n  render() {\n    const { width, height, currentDataType } = this.state;\n    console.log(\"currentDataType:\", currentDataType);\n\n    return (\n      <div>\n        <div id=\"nav\">\n          <h2>\n            CO<sub>2</sub> Dashboard\n          </h2>\n          <p>\n            Explore CO<sub>2</sub> emissions by year. Current year:{\" \"}\n            <span id=\"year-val\"></span>\n            <input id=\"year\" type=\"range\" step=\"1\" />\n          </p>\n          <p>\n            Choose between total emissions or emissions per capita.\n            <input\n              type=\"radio\"\n              name=\"data-type\"\n              value=\"emissions\"\n              defaultChecked\n            />\n            <label>Emissions</label>\n            <input type=\"radio\" name=\"data-type\" value=\"emissionsPerCapita\" />\n            <label>Emissions Per Capita</label>\n          </p>\n          <p>Click on a country to see its trends by year.</p>\n        </div>\n        <div className=\"container\">\n          <div className=\"chart-container\">\n            <div ref=\"mapChart\" style={{ width: width, height: height }}></div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default MapChartWrapper;\n"]},"metadata":{},"sourceType":"module"}